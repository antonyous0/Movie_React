{"ast":null,"code":"import _defineProperty from\"C:/Users/79227/OneDrive/Desktop/react/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/79227/OneDrive/Desktop/react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"C:/Users/79227/OneDrive/Desktop/react/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/79227/OneDrive/Desktop/react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useCallback,useState}from\"react\";import style from\"./MovieCreateForm.module.css\";import{useOutletContext}from\"react-router-dom\";import{createMovie}from\"../../Services/apiService\";import{HorizontalLine}from\"../HorizontalLine/HorizontalLine\";import{useNavigate}from\"react-router-dom\";import{NotificationManager}from\"react-notifications\";import{Input}from\"../Input/Input\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var labelsTemplate={title:\"Название фильма\",year:\"Год выпуска\",plot:\"Описание\",posterUrl:\"Укажите ссылку на обложку\",rate:\"Рейтинг\",actors:\"Укажите список актеров\",director:\"Режиссер\",genres:\"Укажите список жанров\",runtime:\"Укажите продолжительность\"};var placeholdersTemplate={title:\"Введите название фильма\",year:\"Введите год выпуска\",plot:\"Введите ...\",posterUrl:\"Введите ...\",rate:\"Задайте рейтинг\",actors:\"Введите актеров (через ,)\",director:\"Введите ...\",genres:\"Введите ...\",runtime:\"Введите продолжительность\"};var initMovieData={id:0,title:\"\",year:0,plot:\"\",posterUrl:\"\",rate:0,actors:\"\",genres:[],runtime:0,director:\"\"};export var MovieCreateForm=function MovieCreateForm(){var navigate=useNavigate();var _useState=useState(initMovieData),_useState2=_slicedToArray(_useState,2),movie=_useState2[0],setMovie=_useState2[1];var _useOutletContext=useOutletContext(),_useOutletContext2=_slicedToArray(_useOutletContext,1),setMovies=_useOutletContext2[0];var saveData=function saveData(){createMovie(movie).then(function(response){setMovies(function(movies){return[].concat(_toConsumableArray(movies),[response]);});NotificationManager.success(\"\".concat(movie===null||movie===void 0?void 0:movie.title),\"Фильм создан\");navigate(\"/movies/\".concat(response.id));}).catch(function(){NotificationManager.success(\"\".concat(movie===null||movie===void 0?void 0:movie.title),\"Ошибка создания\");});};var handleChangeFor=useCallback(function(propertyName){return function(event){var newValue=event.target.value;if(propertyName===\"genres\"){newValue=newValue.split(\",\");}setMovie(function(movie){return _objectSpread(_objectSpread({},movie),{},_defineProperty({},propertyName,newValue));});};},[]);return/*#__PURE__*/_jsxs(\"form\",{className:style.form,children:[/*#__PURE__*/_jsx(\"div\",{className:style.title,children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(Input,{label:labelsTemplate.title,placeholder:placeholdersTemplate.title,value:movie===null||movie===void 0?void 0:movie.title,id:\"title\",onChange:handleChangeFor}),/*#__PURE__*/_jsx(Input,{label:labelsTemplate.year,placeholder:placeholdersTemplate.year,value:String(movie===null||movie===void 0?void 0:movie.year),id:\"year\",onChange:handleChangeFor}),/*#__PURE__*/_jsx(Input,{label:labelsTemplate.plot,placeholder:placeholdersTemplate.plot,value:movie===null||movie===void 0?void 0:movie.plot,id:\"plot\",onChange:handleChangeFor}),/*#__PURE__*/_jsx(Input,{label:labelsTemplate.posterUrl,placeholder:placeholdersTemplate.posterUrl,value:movie===null||movie===void 0?void 0:movie.posterUrl,id:\"posterUrl\",onChange:handleChangeFor}),/*#__PURE__*/_jsx(Input,{label:labelsTemplate.rate,placeholder:placeholdersTemplate.rate,value:String(movie===null||movie===void 0?void 0:movie.rate),id:\"rate\",onChange:handleChangeFor}),/*#__PURE__*/_jsx(Input,{label:labelsTemplate.actors,placeholder:placeholdersTemplate.actors,value:movie===null||movie===void 0?void 0:movie.actors,id:\"actors\",onChange:handleChangeFor}),/*#__PURE__*/_jsx(Input,{label:labelsTemplate.director,placeholder:placeholdersTemplate.director,value:movie===null||movie===void 0?void 0:movie.director,id:\"director\",onChange:handleChangeFor}),/*#__PURE__*/_jsx(Input,{label:labelsTemplate.genres,placeholder:placeholdersTemplate.genres,value:String(movie===null||movie===void 0?void 0:movie.genres),id:\"genres\",onChange:handleChangeFor}),/*#__PURE__*/_jsx(Input,{label:labelsTemplate.runtime,placeholder:placeholdersTemplate.runtime,value:String(movie===null||movie===void 0?void 0:movie.runtime),id:\"runtime\",onChange:handleChangeFor}),/*#__PURE__*/_jsx(HorizontalLine,{}),/*#__PURE__*/_jsxs(\"div\",{className:style.footer,children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:style.cancelButton,onClick:function onClick(){navigate(\"/movies\");},children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:style.saveButton,onClick:function onClick(){saveData();},children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]})]});};","map":{"version":3,"names":["React","useCallback","useState","style","useOutletContext","createMovie","HorizontalLine","useNavigate","NotificationManager","Input","labelsTemplate","title","year","plot","posterUrl","rate","actors","director","genres","runtime","placeholdersTemplate","initMovieData","id","MovieCreateForm","navigate","movie","setMovie","setMovies","saveData","then","response","movies","success","catch","handleChangeFor","propertyName","event","newValue","target","value","split","form","String","footer","cancelButton","saveButton"],"sources":["C:/Users/79227/OneDrive/Desktop/react/src/components/MovieCreateForm/MovieCreateForm.tsx"],"sourcesContent":["import React, { useCallback, useState } from \"react\";\r\nimport style from \"./MovieCreateForm.module.css\";\r\nimport { useOutletContext } from \"react-router-dom\";\r\nimport { createMovie } from \"../../Services/apiService\";\r\nimport { MovieDetailsData } from \"../../types\";\r\nimport { HorizontalLine } from \"../HorizontalLine/HorizontalLine\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { NotificationManager } from \"react-notifications\";\r\nimport { Input } from \"../Input/Input\";\r\n\r\nconst labelsTemplate = {\r\n  title: \"Название фильма\",\r\n  year: \"Год выпуска\",\r\n  plot: \"Описание\",\r\n  posterUrl: \"Укажите ссылку на обложку\",\r\n  rate: \"Рейтинг\",\r\n  actors: \"Укажите список актеров\",\r\n  director: \"Режиссер\",\r\n  genres: \"Укажите список жанров\",\r\n  runtime: \"Укажите продолжительность\",\r\n};\r\n\r\nconst placeholdersTemplate = {\r\n  title: \"Введите название фильма\",\r\n  year: \"Введите год выпуска\",\r\n  plot: \"Введите ...\",\r\n  posterUrl: \"Введите ...\",\r\n  rate: \"Задайте рейтинг\",\r\n  actors: \"Введите актеров (через ,)\",\r\n  director: \"Введите ...\",\r\n  genres: \"Введите ...\",\r\n  runtime: \"Введите продолжительность\",\r\n};\r\n\r\nconst initMovieData = {\r\n  id: 0,\r\n  title: \"\",\r\n  year: 0,\r\n  plot: \"\",\r\n  posterUrl: \"\",\r\n  rate: 0,\r\n  actors: \"\",\r\n  genres: [],\r\n  runtime: 0,\r\n  director: \"\",\r\n};\r\n\r\nexport const MovieCreateForm = () => {\r\n  const navigate = useNavigate();\r\n  const [movie, setMovie] = useState<MovieDetailsData>(initMovieData);\r\n  const [setMovies]: any = useOutletContext();\r\n\r\n  const saveData = () => {\r\n    createMovie(movie)\r\n      .then((response) => {\r\n        setMovies((movies: MovieDetailsData[]) => [...movies, response]);\r\n        NotificationManager.success(`${movie?.title}`, \"Фильм создан\");\r\n        navigate(`/movies/${response.id}`);\r\n      })\r\n      .catch(() => {\r\n        NotificationManager.success(`${movie?.title}`, \"Ошибка создания\");\r\n      });\r\n  };\r\n\r\n  const handleChangeFor = useCallback(\r\n    (propertyName: string) => (event: { target: { value: any } }) => {\r\n      let newValue = event.target.value;\r\n      if (propertyName === \"genres\") {\r\n        newValue = newValue.split(\",\");\r\n      }\r\n      setMovie((movie) => ({\r\n        ...movie,\r\n        [propertyName]: newValue,\r\n      }));\r\n    },\r\n    []\r\n  );\r\n\r\n  return (\r\n    <form className={style.form}>\r\n      <div className={style.title}>Создание</div>\r\n\r\n      <Input\r\n        label={labelsTemplate.title}\r\n        placeholder={placeholdersTemplate.title}\r\n        value={movie?.title}\r\n        id=\"title\"\r\n        onChange={handleChangeFor}\r\n      />\r\n\r\n      <Input\r\n        label={labelsTemplate.year}\r\n        placeholder={placeholdersTemplate.year}\r\n        value={String(movie?.year)}\r\n        id=\"year\"\r\n        onChange={handleChangeFor}\r\n      />\r\n\r\n      <Input\r\n        label={labelsTemplate.plot}\r\n        placeholder={placeholdersTemplate.plot}\r\n        value={movie?.plot}\r\n        id=\"plot\"\r\n        onChange={handleChangeFor}\r\n      />\r\n\r\n      <Input\r\n        label={labelsTemplate.posterUrl}\r\n        placeholder={placeholdersTemplate.posterUrl}\r\n        value={movie?.posterUrl}\r\n        id=\"posterUrl\"\r\n        onChange={handleChangeFor}\r\n      />\r\n\r\n      <Input\r\n        label={labelsTemplate.rate}\r\n        placeholder={placeholdersTemplate.rate}\r\n        value={String(movie?.rate)}\r\n        id=\"rate\"\r\n        onChange={handleChangeFor}\r\n      />\r\n\r\n      <Input\r\n        label={labelsTemplate.actors}\r\n        placeholder={placeholdersTemplate.actors}\r\n        value={movie?.actors}\r\n        id=\"actors\"\r\n        onChange={handleChangeFor}\r\n      />\r\n\r\n      <Input\r\n        label={labelsTemplate.director}\r\n        placeholder={placeholdersTemplate.director}\r\n        value={movie?.director}\r\n        id=\"director\"\r\n        onChange={handleChangeFor}\r\n      />\r\n\r\n      <Input\r\n        label={labelsTemplate.genres}\r\n        placeholder={placeholdersTemplate.genres}\r\n        value={String(movie?.genres)}\r\n        id=\"genres\"\r\n        onChange={handleChangeFor}\r\n      />\r\n\r\n      <Input\r\n        label={labelsTemplate.runtime}\r\n        placeholder={placeholdersTemplate.runtime}\r\n        value={String(movie?.runtime)}\r\n        id=\"runtime\"\r\n        onChange={handleChangeFor}\r\n      />\r\n\r\n      <HorizontalLine />\r\n\r\n      <div className={style.footer}>\r\n        <button\r\n          type=\"button\"\r\n          className={style.cancelButton}\r\n          onClick={() => {\r\n            navigate(`/movies`);\r\n          }}\r\n        >\r\n          Отменить\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          className={style.saveButton}\r\n          onClick={() => {\r\n            saveData();\r\n          }}\r\n        >\r\n          Сохранить\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}